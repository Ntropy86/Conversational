const fs=require('fs');const path=require('path');const reportPath=path.resolve(__dirname,'frontend/.next/report.html');const s=fs.readFileSync(reportPath,'utf8');const key='window.chartData';let idx=0;let found=false;while(true){idx=s.indexOf(key,idx);if(idx===-1)break;let eq=s.indexOf('=',idx);if(eq===-1){idx+=key.length;continue;}let i=eq+1;while(i<s.length&&/\s/.test(s[i]))i++;if(s[i]==='['){found=true;let start=i;let depth=0;let j=start;for(;j<s.length;j++){const ch=s[j];if(ch==='[')depth++;else if(ch===']'){depth--;if(depth===0){j++;break;}}}const payload=s.slice(start,j);try{const data=JSON.parse(payload);let totalStat=0,totalParsed=0,totalGzip=0;data.forEach(c=>{totalStat+=c.statSize||0;totalParsed+=c.parsedSize||0;totalGzip+=c.gzipSize||0});function fmt(n){return isFinite(n)?(Math.round(n/1024*10)/10+' KB'):'-';}data.sort((a,b)=>(b.statSize||0)-(a.statSize||0));console.log('chunks:',data.length);console.log('total statSize:',fmt(totalStat),' total parsedSize:',fmt(totalParsed),' total gzipSize:',fmt(totalGzip));console.log('\nTop 12 chunks by statSize:');data.slice(0,12).forEach((c,idx)=>{console.log(`\n#${idx+1} name:${c.label||c.name||c.id||"(unknown)"} id:${c.id||"?"} stat:${fmt(c.statSize||0)} parsed:${fmt(c.parsedSize||0)} gzip:${fmt(c.gzipSize||0)} modules:${(c.groups?"has groups":"no groups")}`);if(c.groups){let mods=[];const collect=(g,acc,limit)=>{for(const m of g){if(m.path)acc.push({path:m.path,stat:m.statSize||0,parsed:m.parsedSize||0});if(m.groups)collect(m.groups,acc,limit);if(acc.length>=limit)break}};collect(c.groups,mods,6);if(mods.length){console.log('  example modules:');mods.forEach(m=>console.log(`    - ${m.path} stat:${fmt(m.stat)} parsed:${fmt(m.parsed)}`));}}});process.exit(0);}catch(err){console.error('JSON parse failed at occurrence index',idx,err.message);console.log(payload.slice(0,500));process.exit(5);} }idx+=key.length;}if(!found){console.error('no suitable window.chartData assignment with array found');process.exit(6);}